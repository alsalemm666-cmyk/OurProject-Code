<!DOCTYPE html>
<html lang="ar" dir="rtl" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${pageTitle} ?: 'الصفحة الرئيسية'">الصفحة الرئيسية</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="icon" type="image/png" th:href="@{/img/logoo.png}">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
        }
        .app-header { background-color: #3f51b5; box-shadow: 0 2px 10px rgba(0,0,0,0.2); padding:1rem 0; margin-bottom:2rem; }
        .hero-section { background: rgba(255,255,255,0.9); border-radius:15px; padding:3rem; box-shadow:0 10px 30px rgba(0,0,0,0.1); }
        .welcome-text { color:#333; font-size:2.5rem; font-weight:bold; }
        .subtitle { color:#666; font-size:1.2rem; margin-bottom:2rem; }
        .btn-primary { background: linear-gradient(45deg,#007bff,#0056b3); border:none; border-radius:25px; padding:0.75rem 2rem; font-size:1.1rem; transition: transform 0.2s; }
        .card { border:none; border-radius:15px; box-shadow:0 5px 15px rgba(0,0,0,0.1); background: rgba(255,255,255,0.95); }
        .list-group-item { background: #f8f9fa; }
        .app-footer { background-color: rgba(0,0,0,0.2); border-top:1px solid rgba(255,255,255,0.1); color: rgba(255,255,255,0.8); padding-top:2rem !important; }
        .app-footer a { color: rgba(255,255,255,0.75); }
        .app-footer a:hover { color: #ffffff; }
        .social-icon { font-size:1.5rem; margin:0 0.5rem; }
        .logo-img { max-width: 300px; }
    </style>
</head>
<body class="d-flex flex-column min-vh-100"> 
<header class="app-header">
    <div class="container d-flex justify-content-between align-items-center">
        <h3 class="m-0 text-white">
            <img th:src="@{/img/logo.png}" alt="شعار المغسلة" class="logo-img" />
        </h3>

        <nav>
            <a href="/home" class="text-white mx-2 text-decoration-none">الرئيسية</a>
            <a href="/services" class="text-white mx-2 text-decoration-none">الخدمات</a>
            <a href="/orders/create" class="text-white mx-2 text-decoration-none">إنشاء طلب</a>

            <!-- أزرار قبل تسجيل الدخول -->
            <a id="loginBtn" href="/login" class="btn btn-light btn-sm mx-2">تسجيل الدخول</a>
            <a id="registerBtn" href="/register" class="btn btn-outline-light btn-sm mx-2">إنشاء حساب</a>

            <!-- يظهر فقط بعد تسجيل الدخول -->
            <a id="profileMenu" href="/profile" class="d-none">
                <img src="/img/user.png" class="rounded-circle" width="40" height="40" />
            </a>
            <button id="logoutBtn" class="btn btn-danger btn-sm mx-2 d-none">تسجيل الخروج</button>
        </nav>
    </div>
</header>


    <main class="flex-grow-1">
        <section class="container my-5">
            <div class="hero-section text-center">
                <h2 class="welcome-text">
                    <i class="fas fa-hand-wave icon"></i>
                    مرحبًا <span id="usernameDisplay">الضيف</span>
                </h2>
                <p class="subtitle">
                    <i class="fas fa-tshirt icon"></i>
                    نظام إدارة المغاسل - تتبع طلباتك بكل سهولة
                </p>
                <a th:href="@{/orders/create}" class="btn btn-primary">
                    <i class="fas fa-plus-circle icon"></i>
                    إنشاء طلب جديد
                </a>
            </div>

            <div class="card shadow-sm mt-5">
                <div class="card-body">
                    <h5>
                        <i class="fas fa-list icon"></i>
                        الطلبات الأخيرة
                    </h5>
                    <div th:if="${orders == null or orders.size() == 0}" class="no-orders">
                        <i class="fas fa-inbox fa-3x mb-3"></i><br>
                        لا توجد طلبات حالياً.
                    </div>
                    <ul class="list-group" th:each="order : ${orders}">
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <strong th:text="'طلب #' + ${order.id}"></strong> — 
                                <span th:text="${order.status}" class="badge bg-secondary">قيد التنفيذ</span>
                            </div>
                            <a th:href="@{/orders/{id}(id=${order.id})}" class="btn btn-sm btn-outline-secondary">
                                <i class="fas fa-eye icon"></i> عرض التفاصيل
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </section>
    </main>

    <footer class="app-footer pt-5 pb-3 mt-auto">
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-4">
                    <h5>نظام إدارة المغاسل</h5>
                    <p class="small">
                        تطبيق متكامل لتتبع وإدارة طلبات المغاسل بكل سهولة وسرعة.
                    </p>
                </div>
                <div class="col-md-5 mb-4">
                    <h5>تواصل معنا</h5>
                    <ul class="list-unstyled small">
                        <li><i class="fas fa-map-marker-alt me-2"></i> المملكة العربية السعودية</li>
                        <li><i class="fas fa-envelope me-2"></i> info@laundryapp.com</li>
                        <li><i class="fas fa-phone me-2"></i> +966 50 XXX XXXX</li>
                    </ul>
                    <div class="mt-3">
                        <a href="#" class="social-icon text-white"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="social-icon text-white"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="social-icon text-white"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
            </div>
            <hr class="mt-2 mb-3" style="border-color: rgba(255, 255, 255, 0.3);">
            <div class="row">
                <div class="col-12 text-center small">
                    &copy; <span th:text="${#dates.format(#dates.createNow(), 'yyyy')}">2025</span> جميع الحقوق محفوظة لنظام المغاسل الذكي.
                </div>
            </div>
        </div>
    </footer>
<script>
    // قراءة المستخدم من localStorage
    const user = JSON.parse(localStorage.getItem("user"));

    const usernameDisplay = document.getElementById("usernameDisplay");
    const loginBtn = document.getElementById("loginBtn");
    const registerBtn = document.getElementById("registerBtn");
    const profileMenu = document.getElementById("profileMenu");
    const logoutBtn = document.getElementById("logoutBtn");

    if (user) {
        // عرض الاسم
        usernameDisplay.textContent = user.name;

        // إخفاء أزرار تسجيل الدخول
        loginBtn.classList.add("d-none");
        registerBtn.classList.add("d-none");

        // إظهار صورة البروفايل وزر تسجيل الخروج
        profileMenu.classList.remove("d-none");
        logoutBtn.classList.remove("d-none");
    } else {
        usernameDisplay.textContent = "الضيف";
    }

    // زر تسجيل الخروج
    logoutBtn.addEventListener("click", function () {
        // حذف بيانات المستخدم
        localStorage.removeItem("user");

        // توجيه المستخدم لصفحة تسجيل الدخول
        window.location.href = "/login";
    });
</script>

</body>
</html>
