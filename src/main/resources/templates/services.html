<!DOCTYPE html>
<html lang="ar" dir="rtl" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>الخدمات</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.rtl.min.css" rel="stylesheet">

  <!-- Icons -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

  <!-- Custom CSS -->
  <link rel="stylesheet" th:href="@{/css/main.css}">
  <link rel="stylesheet" th:href="@{/css/header.css}">
  <link rel="stylesheet" th:href="@{/css/services.css}">
</head>

<body>

  <!-- =============================== HEADER =============================== -->
  <header class="app-header">
    <div class="container d-flex justify-content-between align-items-center">

      <h3 class="m-0 text-white">
        <img th:src="@{/img/logo.png}" alt="logo" class="logo-img">
      </h3>

      <nav class="d-flex align-items-center">

        <a th:href="@{/home}" class="text-white mx-2 text-decoration-none">الرئيسية</a>
        <a th:href="@{/services}" class="text-white mx-2 text-decoration-none fw-bold">الخدمات</a>
        <a th:href="@{/orders/create}" class="text-white mx-2 text-decoration-none">إنشاء طلب</a>

        <a th:href="@{/cart}" class="text-white mx-2 text-decoration-none">
          <i class="fa fa-shopping-cart"></i> السلة
        </a>

        <!-- زر تسجيل الدخول -->
        <a id="loginBtn" th:href="@{/login}" class="btn btn-light btn-sm mx-2">تسجيل الدخول</a>

        <!-- صورة البروفايل -->
        <img id="profileAvatar"
             src="https://cdn-icons-png.flaticon.com/512/3177/3177440.png"
             style="display:none; cursor:pointer; border-radius:50%; width:40px; height:40px;"
             onclick="window.location.href='/profile'">
      </nav>

    </div>
  </header>

  <!-- =============================== MAIN =============================== -->
  <main class="container py-4">

    <h2 class="text-center text-white mb-4">
      <i class="fa fa-basket-shopping"></i> خدماتنا
    </h2>

    <div class="row g-4">

      <!-- بطاقة خدمة -->
      <div class="col-md-4" th:each="service : ${services}">
        <div class="service-card p-3 text-center">

          <img src="https://cdn-icons-png.flaticon.com/512/869/869869.png"
               alt="Laundry Icon"
               class="mb-3"
               style="width:80px;">

          <h4 th:text="${service.name}">اسم الخدمة</h4>

          <p class="text-muted" th:text="${service.description}">
            وصف الخدمة
          </p>

          <div class="service-price mb-2">
            <span th:text="${service.price} + ' ريال'"></span>
          </div>

          <button class="btn btn-primary w-100 mt-2 addToCartBtn"
                  th:data-id="${service.id}"
                  th:data-name="${service.name}"
                  th:data-price="${service.price}">
            <i class="fa fa-cart-plus"></i> إضافة للسلة
          </button>

        </div>
      </div>

    </div>

  </main>

  <!-- =============================== FOOTER =============================== -->
  <footer class="app-footer text-center py-3 mt-4">
    <p class="text-white-50">© 2025 نظام المغاسل الذكي - جميع الحقوق محفوظة</p>
  </footer>

  <!-- =============================== JS =============================== -->
  <script>
    /***********************
     *** login display ***
    ************************/
    const user = JSON.parse(localStorage.getItem("user"));
    const loginBtn = document.getElementById("loginBtn");
    const profileAvatar = document.getElementById("profileAvatar");

    if (user) {
      loginBtn.style.display = "none";
      profileAvatar.style.display = "block";

      if (user.profileImage) {
        profileAvatar.src = user.profileImage;
      }
    }

    /***********************
     *** Add to cart ***
    ************************/
function addToCart(id, name, price) {

    let cart = JSON.parse(localStorage.getItem("cart")) || [];

    cart.push({
        id: id,
        quantity: 1
    });

    localStorage.setItem("cart", JSON.stringify(cart));

    alert("تمت إضافة الخدمة إلى السلة ✔");
};
  </script>

</body>

</html>
